import{r as o,A as b,j as e,L as R}from"./index-CtDtNwU0.js";import{a as u}from"./index-NIGUFBhG.js";function k(){const[c,h]=o.useState([]),[n,p]=o.useState(null),[f,x]=o.useState(!1),[i,j]=o.useState(""),[l,y]=o.useState("");o.useEffect(()=>{m(),N()},[]);const m=async()=>{try{x(!0);const s=await u.get(`${b}/validar-telefonos`);h(s.data.datos),x(!1)}catch(s){console.error("Error al cargar datos:",s),x(!1)}},N=async()=>{try{const s=await u.get(`${b}/estadisticas-telefonos`);p(s.data)}catch(s){console.error("Error al cargar estad√≠sticas:",s)}},g=c.filter(s=>{const d=!i||s.riesgo===i,a=!l||s.telefono.includes(l)||s.clientes.some(r=>r.toLowerCase().includes(l.toLowerCase()));return d&&a}),v=()=>{const d=[["Tel√©fono","Clientes Distintos","Veces Usado","Riesgo","√öltima Fecha","Cantidad Sucursales","Sucursales","Lista de Clientes"].join(","),...g.map(t=>[`"${t.telefono}"`,t.clientesDistintos,t.vecesUsado,t.riesgo,`"${t.ultimaFechaRegistro?new Date(t.ultimaFechaRegistro).toLocaleDateString("es-ES"):"Sin fecha"}"`,t.cantidadSucursales||t.sucursales?.length||0,`"${t.sucursales?t.sucursales.join(" | "):""}"`,`"${t.clientes.join(" | ")}"`].join(","))].join(`
`),a=new Blob([d],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),S=URL.createObjectURL(a);r.setAttribute("href",S),r.setAttribute("download",`telefonos_duplicados_${new Date().toISOString().split("T")[0]}.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)},w=s=>{switch(s){case"Alto":return"text-red-400 bg-red-900/30 border-red-500/30";case"Medio":return"text-yellow-400 bg-yellow-900/30 border-yellow-500/30";case"Bajo":return"text-green-400 bg-green-900/30 border-green-500/30";default:return"text-gray-400 bg-gray-900/30 border-gray-500/30"}};return e.jsx("div",{className:"p-6 min-h-screen bg-gradient-to-br from-slate-900 via-gray-900 to-slate-800",children:e.jsxs("div",{className:"backdrop-blur-xl bg-white/5 rounded-2xl shadow-2xl p-6 max-w-full mx-2 md:mx-8 border border-white/10",children:[e.jsxs("div",{className:"flex justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-100 drop-shadow-lg",children:"üì± Validador de Tel√©fonos Duplicados"}),e.jsx("p",{className:"text-gray-300 mt-2 text-lg",children:"Detecta clientes que comparten el mismo n√∫mero de tel√©fono"})]}),e.jsx(R,{to:"/dashboard-sucursales",className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 hover:scale-105 shadow-lg flex items-center gap-2",children:"üè¢Dashboard sucursales"})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500/20 to-blue-600/10 backdrop-blur-sm border border-blue-500/30 rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"text-blue-400 text-3xl font-bold mb-2",children:parseInt(n.total_registros).toLocaleString()}),e.jsx("div",{className:"text-gray-300 text-sm font-medium",children:"Total Registros"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500/20 to-green-600/10 backdrop-blur-sm border border-green-500/30 rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"text-green-400 text-3xl font-bold mb-2",children:parseInt(n.telefonos_unicos).toLocaleString()}),e.jsx("div",{className:"text-gray-300 text-sm font-medium",children:"Tel√©fonos √önicos"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500/20 to-purple-600/10 backdrop-blur-sm border border-purple-500/30 rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"text-purple-400 text-3xl font-bold mb-2",children:parseInt(n.clientes_unicos).toLocaleString()}),e.jsx("div",{className:"text-gray-300 text-sm font-medium",children:"Clientes √önicos"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-500/20 to-red-600/10 backdrop-blur-sm border border-red-500/30 rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"text-red-400 text-3xl font-bold mb-2",children:c.length}),e.jsx("div",{className:"text-gray-300 text-sm font-medium",children:"N√∫meros Problem√°ticos"})]})]}),e.jsxs("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6 mb-8 shadow-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Buscar por tel√©fono o cliente...",className:"border border-gray-600/50 bg-gray-900/50 text-gray-100 placeholder-gray-400 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",value:l,onChange:s=>y(s.target.value)}),e.jsxs("select",{className:"border border-gray-600/50 bg-gray-900/50 text-gray-100 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",value:i,onChange:s=>j(s.target.value),children:[e.jsx("option",{value:"",children:"Todos los niveles de riesgo"}),e.jsx("option",{value:"Alto",children:"üî¥ Riesgo Alto"}),e.jsx("option",{value:"Medio",children:"üü° Riesgo Medio"}),e.jsx("option",{value:"Bajo",children:"üü¢ Riesgo Bajo"})]}),e.jsx("button",{onClick:m,className:"bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white px-6 py-3 rounded-lg font-semibold shadow-lg transition-all duration-300 hover:scale-105",children:"üîÑ Actualizar"})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:v,disabled:!c.length,className:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 disabled:from-gray-600 disabled:to-gray-500 text-white px-6 py-3 rounded-lg font-semibold shadow-lg transition-all duration-300 hover:scale-105 disabled:scale-100",children:"üìä Exportar CSV"})})]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl overflow-hidden shadow-xl",children:f?e.jsx("div",{className:"p-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-400 border-t-transparent"}),e.jsx("div",{className:"text-gray-300 text-xl font-medium",children:"üîç Analizando tel√©fonos duplicados..."}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Esto puede tomar unos momentos"})]})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-700/60 border-b-2 border-gray-600/50",children:[e.jsx("th",{className:"p-4 text-left font-semibold text-gray-100 min-w-[130px]",children:"üì± Tel√©fono"}),e.jsx("th",{className:"p-4 text-center font-semibold text-gray-100 min-w-[100px]",children:"üë• Clientes"}),e.jsx("th",{className:"p-4 text-center font-semibold text-gray-100 min-w-[80px]",children:"üìä Usos"}),e.jsx("th",{className:"p-4 text-center font-semibold text-gray-100 min-w-[100px]",children:"‚ö†Ô∏è Riesgo"}),e.jsx("th",{className:"p-4 text-center font-semibold text-gray-100 min-w-[130px]",children:"üìÖ √öltima Fecha"}),e.jsx("th",{className:"p-4 text-center font-semibold text-gray-100 min-w-[150px]",children:"üè¢ Sucursales"}),e.jsx("th",{className:"p-4 text-left font-semibold text-gray-100 min-w-[250px]",children:"üìã Lista de Clientes"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700/40",children:g.length>0?g.map((s,d)=>e.jsxs("tr",{className:"hover:bg-gray-700/20 transition-colors duration-200",children:[e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-gray-100 font-mono text-base font-medium bg-gray-700/40 px-3 py-2 rounded-lg",children:s.telefono})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"bg-blue-500/20 text-blue-300 px-3 py-2 rounded-lg font-semibold border border-blue-500/30",children:s.clientesDistintos})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"bg-purple-500/20 text-purple-300 px-3 py-2 rounded-lg font-semibold border border-purple-500/30",children:s.vecesUsado})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:`px-4 py-2 rounded-lg text-sm font-bold border ${w(s.riesgo)}`,children:s.riesgo})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 px-3 py-2 rounded-lg text-sm font-medium border border-indigo-500/30",children:s.ultimaFechaRegistro?new Date(s.ultimaFechaRegistro).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"}):"Sin fecha"})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-center",children:e.jsxs("span",{className:"bg-cyan-500/20 text-cyan-300 px-3 py-1 rounded-lg text-sm font-semibold border border-cyan-500/30",children:[s.cantidadSucursales||s.sucursales?.length||0," sucursales"]})}),e.jsx("div",{className:"flex flex-wrap gap-1 max-w-xs mx-auto",children:s.sucursales&&s.sucursales.map((a,r)=>e.jsx("span",{className:"inline-block bg-cyan-800/30 text-cyan-200 px-2 py-1 rounded text-xs border border-cyan-700/30",title:a,children:a.length>12?a.substring(0,12)+"...":a},r))})]})}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"max-w-md space-y-1",children:s.clientes.map((a,r)=>e.jsx("span",{className:"inline-block bg-gray-700/60 text-gray-200 px-3 py-1 rounded-lg text-sm mr-2 mb-1 border border-gray-600/40 font-medium",children:a},r))})})]},d)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center p-12",children:e.jsx("div",{className:"text-gray-400 text-lg",children:l||i?"‚ùå No hay resultados que coincidan con los filtros aplicados":"‚úÖ No se encontraron tel√©fonos duplicados"})})})})]})})}),e.jsx("div",{className:"mt-8 bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6 shadow-lg",children:e.jsxs("div",{className:"text-sm text-gray-300",children:[e.jsxs("p",{className:"mb-4 text-lg font-medium",children:[e.jsx("strong",{className:"text-gray-100",children:"‚ÑπÔ∏è Informaci√≥n:"})," Esta herramienta identifica n√∫meros de tel√©fono compartidos entre diferentes clientes."]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:[e.jsx("span",{className:"text-red-400 font-semibold",children:"üî¥ Riesgo Alto:"}),e.jsx("p",{className:"text-gray-300 text-sm mt-1",children:"4 o m√°s clientes distintos"})]}),e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:[e.jsx("span",{className:"text-yellow-400 font-semibold",children:"üü° Riesgo Medio:"}),e.jsx("p",{className:"text-gray-300 text-sm mt-1",children:"Exactamente 3 clientes distintos"})]}),e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:[e.jsx("span",{className:"text-green-400 font-semibold",children:"üü¢ Riesgo Bajo:"}),e.jsx("p",{className:"text-gray-300 text-sm mt-1",children:"Exactamente 2 clientes distintos"})]})]})]})})]})})}export{k as default};
