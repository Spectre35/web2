import{a as Ee,r as D,j as c,R as Oe,A as L}from"./index-CtDtNwU0.js";import{a as U}from"./index-NIGUFBhG.js";const $=Oe.memo(({value:j,onChange:p,options:b,className:Z=""})=>c.jsxs("select",{className:`w-full bg-gray-800 border border-gray-700 rounded px-3 py-2 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${Z}`,value:j||"",onChange:x=>p(x.target.value),children:[c.jsx("option",{value:"",children:"Selecciona..."}),b.map(x=>c.jsx("option",{value:x,children:x},x))]}));function Ae(){const j={EFEVOO:{nombre:"EFEVOO",camposObligatorios:["PROCESADOR","ID_DE_TRANSACCION","MONTO","FECHA_VENTA","AUTORIZACION"],validaciones:{ID_DE_TRANSACCION:{tipo:"numerico",minLength:8,maxLength:50},AUTORIZACION:{tipo:"alfanumerico",minLength:6,maxLength:12},MONTO:{tipo:"decimal",min:.01,max:999999.99},NUM_DE_TARJETA:{tipo:"numerico",exactLength:[4,6,16]}}},BSD:{nombre:"BSD",camposObligatorios:["PROCESADOR","ID_DEL_COMERCIO_AFILIACION","NOMBRE_DEL_COMERCIO","NUM_DE_TARJETA","FECHA_VENTA","MONTO","AUTORIZACION","FECHA_DE_RESPUESTA"],validaciones:{ID_DEL_COMERCIO_AFILIACION:{tipo:"numerico",minLength:6,maxLength:10},NUM_DE_TARJETA:{tipo:"numerico",exactLength:[4]},MONTO:{tipo:"decimal",min:.01,max:999999.99},AUTORIZACION:{tipo:"numerico",exactLength:[6]}}},CREDOMATIC:{nombre:"CREDOMATIC",camposObligatorios:["PROCESADOR","ID_DE_TRANSACCION","MONTO","FECHA_VENTA","AUTORIZACION","NUM_DE_TARJETA"],validaciones:{ID_DE_TRANSACCION:{tipo:"alfanumerico",minLength:12,maxLength:30},AUTORIZACION:{tipo:"numerico",exactLength:[6,8]},NUM_DE_TARJETA:{tipo:"numerico",exactLength:[16]},MONTO:{tipo:"decimal",min:.01,max:999999.99}}}},p=["PROCESADOR","AÃ‘O","MES_PETICION","EUROSKIN","ID_DEL_COMERCIO_AFILIACION","NOMBRE_DEL_COMERCIO","ID_DE_TRANSACCION","FECHA_VENTA","MONTO","NUM_DE_TARJETA","AUTORIZACION","CLIENTE","VENDEDORA","SUCURSAL","FECHA_CONTRATO","PAQUETE","BLOQUE","FECHA_DE_PETICION","FECHA_DE_RESPUESTA","COMENTARIOS","CAPTURA_CC"];Ee();const[b,Z]=D.useState("EFEVOO"),[x,_]=D.useState(Array(1).fill().map(()=>{const n=Object.fromEntries(p.map(l=>[l,""]));n.EUROSKIN="false";const r=new Date,o=r.getFullYear().toString(),i=["ENERO","FEBRERO","MARZO","ABRIL","MAYO","JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE","NOVIEMBRE","DICIEMBRE"][r.getMonth()];return n.AÃ‘O=o,n.MES_PETICION=i,n})),[X,H]=D.useState({}),[V,R]=D.useState(""),[B,v]=D.useState(!1),[z,k]=D.useState([]),[G,ee]=D.useState([]),[q,te]=D.useState([]),[Q,se]=D.useState([]),[Y,ne]=D.useState([]),[W,J]=D.useState([]);function ae(n,r,o){if(!r||r.toString().trim()==="")return null;const d=j[o];if(!d||!d.validaciones[n])return null;const i=d.validaciones[n],l=r.toString().trim();switch(i.tipo){case"numerico":if(!/^\d+$/.test(l))return"Debe contener solo nÃºmeros";if(i.exactLength&&!i.exactLength.includes(l.length))return`Debe tener ${i.exactLength.join(" o ")} dÃ­gitos`;if(i.minLength&&l.length<i.minLength)return`MÃ­nimo ${i.minLength} dÃ­gitos`;if(i.maxLength&&l.length>i.maxLength)return`MÃ¡ximo ${i.maxLength} dÃ­gitos`;break;case"alfanumerico":if(!/^[a-zA-Z0-9]+$/.test(l))return"Solo se permiten letras y nÃºmeros";if(i.minLength&&l.length<i.minLength)return`MÃ­nimo ${i.minLength} caracteres`;if(i.maxLength&&l.length>i.maxLength)return`MÃ¡ximo ${i.maxLength} caracteres`;break;case"decimal":const h=parseFloat(l);if(isNaN(h))return"Debe ser un nÃºmero vÃ¡lido";if(i.min&&h<i.min)return`MÃ­nimo ${i.min}`;if(i.max&&h>i.max)return`MÃ¡ximo ${i.max}`;break;case"boolean":if(!["true","false","sÃ­","no","si","1","0"].includes(l.toLowerCase()))return"Debe ser SÃ­ o No";break}return null}function re(n,r){const o=j[r];if(!o)return[];const d=[];return o.camposObligatorios.forEach(i=>{(!n[i]||n[i].toString().trim()==="")&&d.push(i)}),d}D.useEffect(()=>{async function n(){try{const[r,o,d,i,l]=await Promise.all([U.get(`${L}/aclaraciones/procesadores`),U.get(`${L}/aclaraciones/sucursales-ventas`),U.get(`${L}/aclaraciones/bloques`),U.get(`${L}/aclaraciones/vendedoras`),U.get(`${L}/aclaraciones/comentarios`)]);k(r.data),ee(o.data),te(d.data),se(i.data),ne(l.data);try{const h=await U.get(`${L}/aclaraciones/captura-cc`);J(h.data)}catch{console.warn("Endpoint captura-cc no disponible, usando valores por defecto"),J(["EN PROCESO","GANADA","PERDIDA"])}}catch(r){console.error("Error al cargar datos iniciales:",r),R("âŒ Error al cargar datos de referencia"),J(["Manual","AutomÃ¡tica","Mixta","No Aplica"])}}n()},[]),D.useEffect(()=>{H({})},[b]);function F(n){if(!n)return"";const r=/^(\d{1,2})[\/-](\d{1,2})[\/-](\d{4})$/,o=n.toString().match(r);if(o)return`${o[3]}-${o[2].padStart(2,"0")}-${o[1].padStart(2,"0")}`;const d=/^(\d{4})-(\d{2})-(\d{2})(?:\s+\d{2}:\d{2}:\d{2})?$/,i=n.toString().match(d);return i?`${i[1]}-${i[2]}-${i[3]}`:n}function P(n){if(!n)return"";if(typeof n=="number")return n;if(typeof n=="string"){let r=n.replace(/[$â‚¬Â£Â¥\s]/g,"");((r.match(/\./g)||[]).length>1||(r.match(/,/g)||[]).length>1)&&(r=r.replace(/\.(?=\d{3,})/g,"").replace(/,(?=\d{3,})/g,"")),r.includes(",")&&!r.includes(".")&&(r=r.replace(",",".")),r.includes(".")&&r.includes(",")&&(r.lastIndexOf(",")>r.lastIndexOf(".")?r=r.replace(".","").replace(",","."):r=r.replace(/,/g,""));const o=parseFloat(r);return isNaN(o)?"":o}return""}function w(n){if(!n)return"";let r=null,o=null,d=null;if(/^\d{4}-\d{2}-\d{2}/.test(n))r=n.split("-"),d=r[0],o=r[1];else if(/^\d{1,2}[\/\-]\d{1,2}[\/\-]\d{4}/.test(n))r=n.split(/[\/\-]/),d=r[2],o=r[1].padStart(2,"0");else return{anio:"",mesNombre:""};const i=["ENERO","FEBRERO","MARZO","ABRIL","MAYO","JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE","NOVIEMBRE","DICIEMBRE"],l=parseInt(o,10)-1,h=i[l]||"";return{anio:d,mesNombre:h}}function oe(n){const r=["ID","FOLIO","CLIENTE","SUCURSAL","NÃšMERO DE TARJETA","MARCA DE TARJETA","TIPO DE TARJETA","MÃ‰TODO DE PAGO","FECHA Y HORA","MONTO","NÃšMERO DE AUTORIZACIÃ“N","AFILIACIÃ“N"],o={ID:"ID_DE_TRANSACCION",FOLIO:"ID_DE_TRANSACCION",CLIENTE:"NOMBRE_DEL_COMERCIO",SUCURSAL:"SUCURSAL","NÃšMERO DE TARJETA":"NUM_DE_TARJETA","MÃ‰TODO DE PAGO":"PROCESADOR","FECHA Y HORA":"FECHA_VENTA",MONTO:"MONTO","NÃšMERO DE AUTORIZACIÃ“N":"AUTORIZACION",AFILIACIÃ“N:"ID_DEL_COMERCIO_AFILIACION",AFILIACION:"ID_DEL_COMERCIO_AFILIACION"},d={...o,AÃ‘O:"AÃ‘O","MES PETICIÃ“N":"MES_PETICION",MES_PETICION:"MES_PETICION",EUROSKIN:"EUROSKIN","ID DEL COMERCIO / AFILIACIÃ“N":"ID_DEL_COMERCIO_AFILIACION","ID DEL COMERCIO":"ID_DEL_COMERCIO_AFILIACION",ID_DE_TRANSACCION:"ID_DE_TRANSACCION","NOMBRE DEL COMERCIO":"NOMBRE_DEL_COMERCIO","FECHA VENTA":"FECHA_VENTA",MONTO:"MONTO","NUM. DE TARJETA":"NUM_DE_TARJETA",NUM_DE_TARJETA:"NUM_DE_TARJETA",AUTORIZACION:"AUTORIZACION",CLIENTE:"CLIENTE",VENDEDORA:"VENDEDORA",SUCURSAL:"SUCURSAL","FECHA CONTRATO":"FECHA_CONTRATO",PAQUETE:"PAQUETE",BLOQUE:"BLOQUE","FECHA DE PETICION":"FECHA_DE_PETICION","FECHA DE RESPUESTA":"FECHA_DE_RESPUESTA",COMENTARIOS:"COMENTARIOS","CAPTURA CC":"CAPTURA_CC",CAPTURA_CC:"CAPTURA_CC"};n.preventDefault();const i=(n.clipboardData||window.clipboardData).getData("text");if(!i)return;const l=i.split(/\r?\n/).filter(E=>E.trim());if(i.includes("DATOS DE LA TRANSACCIÃ“N")||i.includes("No. caso:")||i.includes("Afiliado Pagador:")){const E={},I=i.match(/Fecha:\s*(\d{2}\/\d{2}\/\d{4})/),O=i.match(/SeÃ±ores:\s*([^\n\r]+)/),u=i.match(/Monto de la TransacciÃ³n:\s*([\d,.]+)/),f=i.match(/NÃºmero de Tarjeta:\s*(\d+X+\d+)/),A=i.match(/CÃ³digo de AutorizaciÃ³n:\s*(\d+)/),a=i.match(/No\.\s*caso:\s*([^\n\r]+)/),e=i.match(/No. Afiliado:\s*(\d+)/);I&&(E.FECHA_VENTA=F(I[1])),O&&(E.NOMBRE_DEL_COMERCIO=O[1].trim()),u&&(E.MONTO=P(u[1])),f&&(E.NUM_DE_TARJETA=f[1]),A&&(E.AUTORIZACION=A[1]),a&&(E.ID_DE_TRANSACCION=a[1].trim()),e&&(E.ID_DEL_COMERCIO_AFILIACION=e[1]);const t=Object.fromEntries(p.map(s=>[s,E[s]||""]));if(t.PROCESADOR="CREDOMATIC",t.FECHA_VENTA){const{anio:s,mesNombre:C}=w(t.FECHA_VENTA);t.AÃ‘O=s||"",t.MES_PETICION=C||""}_(s=>{if(s.filter(g=>Object.entries(g).filter(([T,M])=>T==="EUROSKIN"&&(M==="false"||M==="")||T==="AÃ‘O"||T==="MES_PETICION"?!1:M!==""&&M!==null&&M!==void 0).length===0).length>0){const g=[...s],N=s.findIndex(T=>Object.entries(T).filter(([K,y])=>K==="EUROSKIN"&&(y==="false"||y==="")||K==="AÃ‘O"||K==="MES_PETICION"?!1:y!==""&&y!==null&&y!==void 0).length===0);return N!==-1&&(g[N]=t),g}else return[t,...s]}),R("âœ… Se detectÃ³ formato CREDOMATIC y se pegÃ³ 1 fila."),setTimeout(()=>R(""),4e3),n.target.value="";return}if(l.length>=2){const E=l[0].split(/\t|\s{2,}/).map(I=>I.trim().toUpperCase());if(E.every(I=>r.includes(I))){const I=l.slice(1),O=E.map(f=>o[f]||f),u=I.map(f=>{const A=f.split(/\t|\s{2,}/),a=Object.fromEntries(p.map(e=>[e,""]));if(O.forEach((e,t)=>{let s=A[t]?A[t].trim():"";e==="MONTO"&&(s=P(s)),e.includes("FECHA")&&s&&(s=F(s)),p.includes(e)&&(a[e]=s)}),a.PROCESADOR="EFEVOO",a.FECHA_VENTA){const{anio:e,mesNombre:t}=w(a.FECHA_VENTA);a.AÃ‘O=e||"",a.MES_PETICION=t||""}return a});_(f=>{const A=f.filter(a=>Object.entries(a).filter(([t,s])=>t==="EUROSKIN"&&(s==="false"||s==="")||t==="AÃ‘O"||t==="MES_PETICION"?!1:s!==""&&s!==null&&s!==void 0).length===0).length;if(u.length<=A){const a=[...f];let e=0;for(let t=0;t<a.length&&e<u.length;t++){const s=a[t];Object.entries(s).filter(([g,N])=>g==="EUROSKIN"&&(N==="false"||N==="")||g==="AÃ‘O"||g==="MES_PETICION"?!1:N!==""&&N!==null&&N!==void 0).length===0&&(a[t]=u[e],e++)}return a}else{const a=[...f];let e=0;for(let s=0;s<a.length&&e<u.length;s++){const C=a[s];Object.entries(C).filter(([N,T])=>N==="EUROSKIN"&&(T==="false"||T==="")||N==="AÃ‘O"||N==="MES_PETICION"?!1:T!==""&&T!==null&&T!==void 0).length===0&&(a[s]=u[e],e++)}return[...u.slice(e),...a]}}),R(`âœ… Se pegaron ${u.length} filas EFEVOO (horizontal)`),setTimeout(()=>R(""),4e3),n.target.value="";return}}const h=["AFILIACION","NOMBRE DEL COMERCIO","BIN TARJETA","TARJETA","FECHA VENTA","HORA","IMPORTE","AUTORIZACION","FECHA CONTRACARGO","REFERENCIA"],m={AFILIACION:"ID_DEL_COMERCIO_AFILIACION","NOMBRE DEL COMERCIO":"NOMBRE_DEL_COMERCIO",TARJETA:"NUM_DE_TARJETA","FECHA VENTA":"FECHA_VENTA",HORA:"HORA",IMPORTE:"MONTO",AUTORIZACION:"AUTORIZACION",REFERENCIA:"ID_DE_TRANSACCION"};if(l.length>10&&h.every((E,I)=>l[I]?.trim().toUpperCase()===E)){const E=h.length,I=Math.floor((l.length-E)/E),O=[];for(let u=0;u<I;u++){const f=E+u*E,A=f+E,a=l.slice(f,A),e={};h.forEach((s,C)=>{let g=a[C]?a[C].trim():"";const N=m[s];N==="MONTO"&&(g=P(g)),N&&N.includes("FECHA")&&g&&(g=F(g)),e[N]=g});const t=Object.fromEntries(p.map(s=>[s,e[s]||""]));if(t.PROCESADOR="BSD",t.FECHA_VENTA){const{anio:s,mesNombre:C}=w(t.FECHA_VENTA);t.AÃ‘O=s||"",t.MES_PETICION=C||""}O.push(t)}_(u=>{const f=u.filter(A=>Object.entries(A).filter(([e,t])=>e==="EUROSKIN"&&(t==="false"||t==="")||e==="AÃ‘O"||e==="MES_PETICION"?!1:t!==""&&t!==null&&t!==void 0).length===0).length;if(O.length<=f){const A=[...u];let a=0;for(let e=0;e<A.length&&a<O.length;e++){const t=A[e];Object.entries(t).filter(([C,g])=>C==="EUROSKIN"&&(g==="false"||g==="")||C==="AÃ‘O"||C==="MES_PETICION"?!1:g!==""&&g!==null&&g!==void 0).length===0&&(A[e]=O[a],a++)}return A}else{const A=[...u];let a=0;for(let t=0;t<A.length&&a<O.length;t++){const s=A[t];Object.entries(s).filter(([g,N])=>g==="EUROSKIN"&&(N==="false"||N==="")||g==="AÃ‘O"||g==="MES_PETICION"?!1:N!==""&&N!==null&&N!==void 0).length===0&&(A[t]=O[a],a++)}return[...O.slice(a),...A]}}),R(`âœ… Se pegaron ${O.length} filas BSD (vertical)`),setTimeout(()=>R(""),4e3),n.target.value="";return}if(l.length>2&&l.every(E=>E.split(/\t|\s{2,}/).length===1)){let E=[];for(let I=0;I<l.length;I++){const O=l[I].trim();isNaN(O)&&!/^\d{1,2}[\/-]\d{1,2}[\/-]\d{4}$/.test(O)&&!/^\$?\s*[\d,.]+$/.test(O)&&E.push(I)}if(E.length>=2){const I=E.map(a=>l[a].trim().toUpperCase()),O=E.map((a,e)=>{const t=E[e+1]||l.length;return l.slice(a+1,t)}),u=Math.max(...O.map(a=>a.length)),f=[];for(let a=0;a<u;a++){const e={};I.forEach((t,s)=>{const C=d[t]||t;e[C]=O[s][a]?O[s][a].trim():""}),e.MONTO&&(e.MONTO=P(e.MONTO)),Object.keys(e).forEach(t=>{t.includes("FECHA")&&(e[t]=F(e[t]))}),f.push(e)}const A=f.map(a=>{const e=Object.fromEntries(p.map(t=>[t,a[t]||""]));if(e.FECHA_VENTA){const{anio:t,mesNombre:s}=w(e.FECHA_VENTA);e.AÃ‘O=t||"",e.MES_PETICION=s||""}return e});_(a=>{const e=[...A];return e.length<=a.length?a.map((t,s)=>e[s]?e[s]:t):[...e.slice(0,a.length),...e.slice(a.length)]}),_(a=>{const e=[...A];return e.length<=a.length?a.map((t,s)=>e[s]?e[s]:t):[...e.slice(0,a.length),...e.slice(a.length)]}),_(a=>{const e=[...A];return e.length<=a.length?a.map((t,s)=>e[s]?e[s]:t):[...e.slice(0,a.length),...e.slice(a.length)]}),R(`âœ… Se pegaron ${A.length} filas (formato transpuesto)`),setTimeout(()=>R(""),4e3),n.target.value="";return}}if(l.length>2&&l.every(E=>E.split(/\t|\s{2,}/).length===2)){const E={};l.forEach(O=>{const[u,f]=O.split(/\t|\s{2,}/);if(u&&f){const A=d[u.trim().toUpperCase()]||u.trim().toUpperCase();E[A]=f.trim()}}),E.MONTO&&(E.MONTO=P(E.MONTO)),Object.keys(E).forEach(O=>{O.includes("FECHA")&&(E[O]=F(E[O]))});const I=Object.fromEntries(p.map(O=>[O,E[O]||""]));if(I.FECHA_VENTA){const{anio:O,mesNombre:u}=w(I.FECHA_VENTA);I.AÃ‘O=O||"",I.MES_PETICION=u||""}_(O=>{if(O.filter(f=>Object.entries(f).filter(([a,e])=>a==="EUROSKIN"&&(e==="false"||e==="")||a==="AÃ‘O"||a==="MES_PETICION"?!1:e!==""&&e!==null&&e!==void 0).length===0).length>0){const f=[...O],A=O.findIndex(a=>Object.entries(a).filter(([t,s])=>t==="EUROSKIN"&&(s==="false"||s==="")||t==="AÃ‘O"||t==="MES_PETICION"?!1:s!==""&&s!==null&&s!==void 0).length===0);return A!==-1&&(f[A]=I),f}else return[I,...O]}),R("âœ… Se detectÃ³ formato vertical y se pegÃ³ 1 fila."),setTimeout(()=>R(""),4e3),n.target.value="";return}if(l.length>=2){const E=l[0].split(/\t|\s{2,}/).map(f=>f.trim().toUpperCase()),I=l.slice(1),O=E.map(f=>d[f]||f),u=I.map(f=>{const A=f.split(/\t|\s{2,}/),a=Object.fromEntries(p.map(e=>[e,""]));if(O.forEach((e,t)=>{if(p.includes(e)){let s=A[t]?A[t].trim():"";e==="MONTO"&&(s=P(s)),e.includes("FECHA")&&s&&(s=F(s)),a[e]=s}}),a.FECHA_VENTA){const{anio:e,mesNombre:t}=w(a.FECHA_VENTA);a.AÃ‘O=e||"",a.MES_PETICION=t||""}return a});_(f=>{if(f.every(e=>Object.entries(e).filter(([s,C])=>s==="EUROSKIN"&&(C==="false"||C==="")||s==="AÃ‘O"||s==="MES_PETICION"?!1:C!==""&&C!==null&&C!==void 0).length===0))return u;const a=f.filter(e=>Object.entries(e).filter(([s,C])=>s==="EUROSKIN"&&(C==="false"||C==="")||s==="AÃ‘O"||s==="MES_PETICION"?!1:C!==""&&C!==null&&C!==void 0).length===0).length;if(u.length<=a){const e=[...f];let t=0;for(let s=0;s<e.length&&t<u.length;s++){const C=e[s];Object.entries(C).filter(([N,T])=>N==="EUROSKIN"&&(T==="false"||T==="")||N==="AÃ‘O"||N==="MES_PETICION"?!1:T!==""&&T!==null&&T!==void 0).length===0&&(e[s]=u[t],t++)}return e}else{const e=[...f];let t=0;for(let C=0;C<e.length&&t<u.length;C++){const g=e[C];Object.entries(g).filter(([T,M])=>T==="EUROSKIN"&&(M==="false"||M==="")||T==="AÃ‘O"||T==="MES_PETICION"?!1:M!==""&&M!==null&&M!==void 0).length===0&&(e[C]=u[t],t++)}return[...u.slice(t),...e]}}),R(`âœ… Se pegaron ${u.length} filas y se mapearon los encabezados: ${O.join(", ")}`),setTimeout(()=>R(""),4e3),n.target.value="";return}R("âŒ No se detectaron encabezados vÃ¡lidos"),setTimeout(()=>R(""),4e3)}async function ie(){v(!0);try{const n=x.filter(i=>Object.values(i).some(l=>l&&l.toString().trim()!==""));if(!n.length){R("âŒ No hay datos para guardar"),v(!1);return}let r=!1;const o={};if(n.forEach((i,l)=>{re(i,b).forEach(m=>{o[`${l}-${m}`]="Campo obligatorio",r=!0}),Object.keys(i).forEach(m=>{if(i[m]&&i[m].toString().trim()!==""){const E=ae(m,i[m],b);E&&(o[`${l}-${m}`]=E,r=!0)}})}),r){H(o),R("âŒ Hay errores de validaciÃ³n. Revisa los campos marcados en rojo."),v(!1),setTimeout(()=>R(""),5e3);return}const d=n.map(i=>({...i,TIPO_TABLA:b}));await U.post(`${L}/aclaraciones/insertar-multiple`,{datos:d,tipoTabla:b}),R(`âœ… Se guardaron ${n.length} registros de ${b} correctamente`),_(Array(1).fill().map(()=>Object.fromEntries(p.map(i=>[i,""])))),H({})}catch(n){R("âŒ Error al guardar los datos: "+(n.response?.data?.message||n.message))}finally{v(!1),setTimeout(()=>R(""),5e3)}}function le(){window.confirm("Â¿EstÃ¡s seguro de que quieres limpiar todos los datos?")&&(_(Array(1).fill().map(()=>Object.fromEntries(p.map(n=>[n,""])))),R("ðŸ§¹ Datos limpiados"),setTimeout(()=>R(""),2e3))}const S=D.useCallback((n,r,o)=>{_(d=>d.map((i,l)=>l===n?{...i,[r]:o}:i))},[]);function ce(n){_(r=>r.filter((o,d)=>d!==n))}return c.jsx("div",{className:"p-4 bg-gray-900 text-gray-200 min-h-screen",children:c.jsxs("div",{className:"w-full max-w-none mx-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-3xl font-bold text-blue-400",children:"Ingresar Aclaraciones"})}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:le,className:"px-4 py-2 bg-gray-700 text-gray-200 rounded hover:bg-gray-600 transition",disabled:B,children:"ðŸ§¹ Limpiar"}),c.jsx("button",{onClick:ie,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",disabled:B,children:B?"Guardando...":"ðŸ’¾ Guardar"})]})]}),V&&c.jsx("div",{className:`mb-4 p-3 rounded ${V.startsWith("âœ…")?"bg-green-900 text-green-200":"bg-red-900 text-red-200"}`,children:V}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Pegar datos (detecta automÃ¡ticamente el formato):"}),c.jsx("textarea",{className:"w-full p-2 bg-gray-800 border border-gray-700 rounded text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4,onPaste:oe,placeholder:"Pega aquÃ­ los datos de aclaraciones..."})]}),c.jsx("div",{className:"bg-gray-800 rounded-lg shadow overflow-hidden mb-4",children:c.jsx("div",{className:"overflow-x-auto custom-scrollbar",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[c.jsx("thead",{className:"bg-gray-700",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider sticky left-0 bg-gray-700 z-10 w-10",children:"#"}),p.map(n=>{const r=j[b]?.camposObligatorios.includes(n);let o="";return n==="NOMBRE_DEL_COMERCIO"?o="min-w-[300px]":n==="CLIENTE"?o="min-w-[200px]":n==="MONTO"?o="min-w-[120px]":n==="NUM_DE_TARJETA"?o="min-w-[150px]":n==="AÃ‘O"&&(o="min-w-[80px]"),c.jsxs("th",{className:`px-3 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider relative ${o}`,children:[n.replace(/_/g," "),r&&c.jsx("span",{className:"text-yellow-400 ml-1",title:"Campo obligatorio",children:"*"})]},n)}),c.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider w-10",children:"AcciÃ³n"})]})}),c.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:x.map((n,r)=>c.jsxs("tr",{className:r%2===0?"bg-gray-800":"bg-gray-750",children:[c.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-300 sticky left-0 bg-inherit z-10",children:r+1}),p.map(o=>{const d=j[b]?.camposObligatorios.includes(o),i=X[`${r}-${o}`],l=i?"border-red-500 bg-red-900/20":"border-gray-700",h=d?"border-yellow-500/50":"";return c.jsxs("td",{className:"px-1 py-1 relative",children:[o==="PROCESADOR"&&z.length>0?c.jsx($,{value:n[o],onChange:m=>S(r,o,m),options:z,className:`${l} ${h}`}):o==="SUCURSAL"&&G.length>0?c.jsx($,{value:n[o],onChange:m=>S(r,o,m),options:G,className:`${l} ${h}`}):o==="BLOQUE"&&q.length>0?c.jsx($,{value:n[o],onChange:m=>S(r,o,m),options:q,className:`${l} ${h}`}):o==="VENDEDORA"&&Q.length>0?c.jsx($,{value:n[o],onChange:m=>S(r,o,m),options:Q,className:`${l} ${h}`}):o==="COMENTARIOS"&&Y.length>0?c.jsx($,{value:n[o],onChange:m=>S(r,o,m),options:Y,className:`min-w-[250px] ${l} ${h}`}):o.includes("FECHA")?c.jsx("input",{type:"date",className:`w-full bg-gray-800 border rounded px-3 py-2 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${l} ${h}`,value:n[o]||"",onChange:m=>S(r,o,m.target.value)}):o==="MONTO"?c.jsx("input",{type:"number",step:"0.01",className:`w-full bg-gray-800 border rounded px-3 py-2 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${l} ${h}`,value:n[o]||"",onChange:m=>S(r,o,m.target.value)}):o==="EUROSKIN"?c.jsxs("select",{className:`w-full bg-gray-800 border rounded px-3 py-2 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${l} ${h}`,value:n[o]||"",onChange:m=>S(r,o,m.target.value),children:[c.jsx("option",{value:"",children:"Selecciona..."}),c.jsx("option",{value:"true",children:"SÃ­"}),c.jsx("option",{value:"false",children:"No"})]}):o==="CAPTURA_CC"&&W.length>0?c.jsx($,{value:n[o],onChange:m=>S(r,o,m),options:W,className:`${l} ${h}`}):c.jsx("input",{type:"text",className:`w-full bg-gray-800 border rounded px-3 py-2 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${l} ${h}`,value:n[o]||"",onChange:m=>S(r,o,m.target.value)}),d&&c.jsx("span",{className:"absolute -top-1 -right-1 text-yellow-400 text-xs",title:"Campo obligatorio",children:"*"}),i&&c.jsx("div",{className:"absolute top-full left-0 mt-1 p-2 bg-red-800 text-red-200 text-xs rounded shadow-lg z-50 whitespace-nowrap",children:i})]},`${r}-${o}`)}),c.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-300",children:c.jsx("button",{onClick:()=>ce(r),className:"text-red-400 hover:text-red-300",title:"Eliminar fila",children:"âŒ"})})]},r))})]})})}),c.jsxs("div",{className:"mt-4 flex justify-between",children:[c.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition",onClick:()=>{const n=Object.fromEntries(p.map(l=>[l,""]));n.EUROSKIN="false";const r=new Date,o=r.getFullYear().toString(),i=["ENERO","FEBRERO","MARZO","ABRIL","MAYO","JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE","NOVIEMBRE","DICIEMBRE"][r.getMonth()];n.AÃ‘O=o,n.MES_PETICION=i,_([...x,n])},children:"+ Agregar fila"}),c.jsxs("div",{className:"text-sm text-gray-400",children:[x.filter(n=>Object.values(n).some(r=>r&&r.toString().trim()!=="")).length," filas con datos"]})]})]})})}export{Ae as default};
